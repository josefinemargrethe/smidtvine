<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <title>Document</title>
    <link rel="stylesheet" href="style.css" />
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;700&family=Poppins:ital,wght@0,300;0,400;0,500;0,600;0,700;1,400&display=swap" rel="stylesheet" />
    <style>
      .content {
        grid-template-columns: 20% 80%;
      }

      #wines {
        margin-top: 20vh;
      }
    </style>
  </head>
  <body>
    <header class="mobil">
      <nav class="mobil">
        <div id="myNav" class="overlay mobile_nav">
          <a href="javascript:void(0)" class="closebtn" onclick="closeNav()">&times;</a>
          <div class="overlay-content">
            <a href="index.html"><img src="img/logo.png" alt="Smidt Vine logo" class="burger_logo" /></a>
            <a href="index.html">Hjem</a>
            <a href="allevine.html">Vine</a>
            <a href="allespecialiteter.html">Specialiteter</a>
            <a href="moed_smidtvine.html">Mød Smidt Vine</a>
            <a href="om.html">Om Smidt Vine</a>
            <p>Mød Vinbønderne</p>
            <a href="nico_mosel.html" class="mobilnav_vinbonde">- Nico i Mosel</a>
            <a href="josep_montsant.html" class="mobilnav_vinbonde">- Josep i Mont Sant</a>
            <a href="kontakt.html">Kontakt</a>
          </div>
        </div>
        <span class="openbtn" onclick="openNav()">&#9776;</span>
      </nav>
    </header>
    <header class="desktop">
      <nav class="desktop desktop_nav" id="desktop_nav">
        <a href="index.html">Hjem</a>
        <a href="allevine.html"><b>Vine</b></a>
        <a href="allespecialiteter.html">Specialiteter</a>
        <a href="moed_smidtvine.html">Mød Smidt Vine</a>
        <a href="om.html">Om Smidt Vine</a>
        <div class="dropdown">
          <p class="dropbtn">
            Mød Vinbønderne
            <i class="fa fa-caret-down"></i>
          </p>
          <div class="dropdown-content">
            <a href="nico_mosel.html" class="mobilnav_vinbonde">- Nico i Mosel</a>
            <a href="josep_montsant.html" class="mobilnav_vinbonde">- Josep i Mont Sant</a>
          </div>
        </div>
        <a href="kontakt.html">Kontakt</a>
      </nav>
    </header>

    <main>
      <!-- <section id="vine_headline">
        <h1><span class="vine_headline">Vine</span></h1>
      </section> -->

      <section id="wines">
        <article class="content">
          <aside id="contextnav">
            <nav>
              <a href="allevine.html">Alle vine</a>
              <a href="roedvine.html">Rødvine</a>
              <a href="hvidvine.html">Hvidvine</a>
              <a href="rosevine.html">Rosé vine</a>
              <a href="smagekasser.html">Smagekasser</a>
            </nav>
          </aside>
          <div id="single_wrapper"></div>
          <template>
            <article id="singleview">
              <article class="single_product">
                <div class="single_wine">
                  <div class="wine_image"></div>
                  <div class="wine_info">
                    <h2 class="wine_name"></h2>
                    <p class="wine_description"></p>
                    <p class="wine_price_six"></p>
                    <p class="wine_price"></p>
                  </div>
                </div>
                <div class="middle"></div>
                <div class="right"></div>
              </article>
            </article>
            <article id="interesse"><h3></h3></article>
            <article id="mix_match">
              <article class="colors"></article>
            </article>
          </template>
          <!-- <div id="single_wrapper">
            <div id="singleview"></div>
            <div id="interesse"></div>
            <div id="mix_match"></div>
          </div> -->
        </article>
      </section>
    </main>

    <footer id="mobile_footer">
      <a href="index.html"><img src="img/logo2.png" alt="Smidt Vine logo" class="footer_logo" /></a>
      <article class="footer_wrapper">
        <article>
          <p>Smidt Vine</p>
          <p>v/Bruno Kristensen</p>
          <p>Strandvej 75</p>
          <p>5700 Svendborg</p>
          <p class="cvr">CVR: 37223115</p>
        </article>
        <article>
          <p>Kontakt:</p>
          <p>Telefon: 21 95 08 75</p>
          <p>
            Mail: <span><a href="mailto:info@smidtvine.dk" target="_blank">info@smidtvine.dk</a></span>
          </p>
          <a href="https://facebook.com/smidtvine" target="_blank">Følg Smidt Vine på Facebook!</a>
        </article>
      </article>
    </footer>
    <footer id="desk_footer">
      <a href="index.html"><img src="img/logo2.png" alt="Smidt Vine logo" class="footer_logo" /></a>
      <p>
        Smidt Vine v/Bruno Kristensen. Strandvej 75. 5700 Svendborg. Cvr: 37223115. Kontakt: Telefon: 21 95 08 75. Mail:
        <span><a href="mailto:info@smidtvine.dk" target="_blank">info@smidtvine.dk</a></span>
      </p>
    </footer>

    <script>
      let urlParams = new URLSearchParams(window.location.search); //API der henter data fra afsendersiden, henter her url query string ?id=123 eller det id der er blevet sendt med fra afsendersiden
      let id = urlParams.get("id"); //returnerer "id"
      let vine = [];
      let vin;
      let itemType;

      window.addEventListener("DOMContentLoaded", loadJSON);

      function loadJSON() {
        fetch("https://josefinemargrethe.dk/kea/4-semester/smidtvine/wordpress/wp-json/wp/v2/vine?per_page=100")
          .then((response) => response.json())
          .then((vine) => {
            //når JSON er loadet tager vi vores data med videre til prepareData
            vine.forEach((obj, i) => {
              if (obj.id == id) {
                vin = obj;
                itemType = obj.vin_type[0];
              }

              //her laves en betingelse som siger, at FØRST når ALLE objekterne i array'et er læst, må der gåes videre til de efterfølgende funktioner. Her bruges tælleren i til at sammenligne med array'ets længde. Da 0. position tælles med er det i +1.

              //console.log(info.length, i)
              if (vine.length == i + 1) {
                openProduct(vine, itemType);
                //   getType(vine);
              }
            });
          });
      }

      function openProduct(vine, itemType) {
        // we are clearing the list
        document.querySelector("#single_wrapper").innerHTML = "";

        // we are building a new list
        vine.forEach(displayData);
      }

      function displayData(vine) {
        // create clone
        const clone = document.querySelector("template").content.cloneNode(true);

        // set clone data
        clone.querySelector(".wine_image").innerHTML = `<img src="${vine.vin_billede.guid}" alt="${vine.vin_billede.post_title}">`;
        clone.querySelector(".wine_name").innerHTML = vine.vin_navn;
        clone.querySelector(".wine_description").innerHTML = vine.kort_beskrivelse;
        clone.querySelector(".wine_price_six").innerHTML = `<b><p>Pris: ${vine.pris_6flasker} kr. ved køb af 6 flasker</p></b>`;

        if (vine.pris_enkeltstyk != "") {
          clone.querySelector(".wine_price").innerHTML = `<p>Ellers ${vine.pris_enkeltstyk} kr. pr. flaske</p>`;
        }

        let theme = vine.vin_type;
        clone.querySelector(".wine_name").setAttribute("data-theme", theme);

        clone.querySelector(".middle").innerHTML = vine.vin_info1;
        clone.querySelector(".right").innerHTML = vine.vin_info2;

        console.log(vine.id + " id = " + id);

        if (vine.vin_type == itemType && vine.id != id) {
          clone.querySelector("#mix_match").innerHTML = `<a href="vin.html?id=${vine.id}"><img src="${vine.vin_billede.guid}" alt="${vine.vin_navn}"></a>`;

          //           document.querySelector("#mix_match").innerHTML += `
          //   <article class="colors">
          //   <a href="vin.html?id=${mix.id}">
          //       <img src="${mix.vin_billede.guid}" alt="${mix.vin_navn}">
          //       </a>
          //   </article>
          //   `;
        }

        document.querySelector("#single_wrapper").appendChild(clone);
      }

      //   let interesse = document.querySelector("#interesse");

      //   if (info.wine_type == "redwine") {
      //     interesse.innerHTML += `<h2>Er du interesseret i rødvin? Se vores andre rødvine her</h2>`;
      //   } else if (info.wine_type == "whitewine") {
      //     interesse.innerHTML += `<h2>Er du interesseret i hvidvin? Se vores andre hvidvine her</h2>`;
      //   } else if (info.wine_type == "rosewine") {
      //     interesse.innerHTML += `<h2>Er du interesseret i rosé vin? Se vores andre rosé vine her</h2>`;
      //   } else {
      //     interesse.innerHTML += `<h2>Er du interesseret i smagekasser? Se vores andre smagekasser her</h2>`;
      //   }

      //   info.forEach((type) => {
      //     if (type.wine_type == "redwine") {
      //       interesse.innerHTML = `<h2>Er du interesseret i rødvin? Se vores andre rødvine her</h2>`;
      //     } else if (type.wine_type == "whitewine") {
      //       interesse.innerHTML = `<h2>Er du interesseret i hvidvin? Se vores andre hvidvine her</h2>`;
      //     } else if (type.wine_type == "rosewine") {
      //       interesse.innerHTML = `<h2>Er du interesseret i rosé vin? Se vores andre rosé vine her</h2>`;
      //     } else {
      //       interesse.innerHTML = `<h2>Er du interesseret i smagekasser? Se vores andre smagekasser her</h2>`;
      //     }
      //   });

      //Her indsættes en HTML-artikel med produktdetaljer og billeder for det produkt, som vores id tilhører i array'et.

      loadJSON();
    </script>
    <script src="header.js"></script>
  </body>
</html>
